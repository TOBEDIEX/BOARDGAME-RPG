-- EventTileHandler.client.lua
-- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ù‡∏±‡πà‡∏á‡πÑ‡∏Ñ‡∏•‡πÄ‡∏≠‡∏ô‡∏ï‡πå (‡∏°‡∏µ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏û‡πà)
-- Version: 7.0.0 - Optimized

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

-- Constants
local DEBUG = true
local MONEY_COLOR = Color3.fromRGB(255, 215, 0)
local SHOP_COLOR = Color3.fromRGB(85, 170, 255)
local BATTLE_COLOR = Color3.fromRGB(255, 80, 80)
local CASINO_COLOR = Color3.fromRGB(220, 120, 255)
local ITEM_COLOR = Color3.fromRGB(100, 255, 100)
local MONEY_RANGE = {500, 2000}
local DELAY_BEFORE_UI = 0.5
local NOTIFY_DURATION = 3

-- Get local player
local player = Players.LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")

-- State variables
local state = {
	pendingMoneyTile = false,
	moneyAmount = 0,
	lastTileId = nil,
	lastTileType = nil,
	isMakingPathChoice = false,
	isMoving = false,
	hasReachedEndTile = false,
	isProcessingEvent = false
}

-- Remote events (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô nil ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÉ‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô initRemotes)
local remotes, eventTileRemotes, moneyEventRemote
local uiRemotes, statChangedEvent
local boardRemotes, tileTriggerEvent, playerArrivedAtTile, movementVisualizationComplete
local showPathSelection, startPlayerMovementPath, activityComplete

-- Helper functions
local function log(msg) if DEBUG then print("[EventTileHandler] " .. msg) end end

local function tweenUI(obj, duration, properties, style, direction, onComplete)
	style = style or Enum.EasingStyle.Quad
	direction = direction or Enum.EasingDirection.Out

	local tween = TweenService:Create(
		obj, 
		TweenInfo.new(duration, style, direction), 
		properties
	)

	if onComplete then tween.Completed:Connect(onComplete) end
	tween:Play()
	return tween
end

local function playSound(parent, soundId, volume)
	local sound = Instance.new("Sound")
	sound.SoundId = soundId
	sound.Volume = volume or 0.5
	sound.Parent = parent
	sound:Play()
	return sound
end

-- Initialize all remote events
local function initRemotes()
	-- Event Tile Remotes
	remotes = ReplicatedStorage:WaitForChild("Remotes")
	eventTileRemotes = remotes:FindFirstChild("EventTileRemotes")
	if not eventTileRemotes then
		eventTileRemotes = Instance.new("Folder")
		eventTileRemotes.Name = "EventTileRemotes"
		eventTileRemotes.Parent = remotes
	end

	moneyEventRemote = eventTileRemotes:FindFirstChild("MoneyEvent")
	if not moneyEventRemote then
		moneyEventRemote = Instance.new("RemoteEvent")
		moneyEventRemote.Name = "MoneyEvent"
		moneyEventRemote.Parent = eventTileRemotes
	end

	-- Board Remotes
	uiRemotes = remotes:WaitForChild("UIRemotes")
	statChangedEvent = uiRemotes:FindFirstChild("StatChanged")

	boardRemotes = remotes:WaitForChild("BoardRemotes")
	tileTriggerEvent = boardRemotes:WaitForChild("TileTriggerEvent")
	playerArrivedAtTile = boardRemotes:WaitForChild("PlayerArrivedAtTile")
	movementVisualizationComplete = boardRemotes:FindFirstChild("MovementVisualizationComplete")
	showPathSelection = boardRemotes:FindFirstChild("ShowPathSelection")
	startPlayerMovementPath = boardRemotes:WaitForChild("StartPlayerMovementPath")
	activityComplete = boardRemotes:FindFirstChild("ActivityComplete")
end

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
local function createNotification(message, duration, color)
	duration = duration or NOTIFY_DURATION
	color = color or MONEY_COLOR

	local notification = Instance.new("Frame")
	notification.Name = "MoneyNotification"
	notification.Size = UDim2.new(0, 280, 0, 60)
	notification.Position = UDim2.new(0.5, 0, -0.2, 0)
	notification.AnchorPoint = Vector2.new(0.5, 0)
	notification.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	notification.BackgroundTransparency = 0.2
	notification.BorderSizePixel = 0

	-- ‡πÄ‡∏û‡∏¥‡πà‡∏° UI Elements
	local corner = Instance.new("UICorner", notification)
	corner.CornerRadius = UDim.new(0, 8)

	local icon = Instance.new("ImageLabel", notification)
	icon.Name = "Icon"
	icon.Size = UDim2.new(0, 32, 0, 32)
	icon.Position = UDim2.new(0, 14, 0.5, 0)
	icon.AnchorPoint = Vector2.new(0, 0.5)
	icon.BackgroundTransparency = 1
	icon.Image = "rbxassetid://3354536235" -- ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç

	local textLabel = Instance.new("TextLabel", notification)
	textLabel.Name = "Message"
	textLabel.Size = UDim2.new(1, -60, 1, 0)
	textLabel.Position = UDim2.new(0, 56, 0, 0)
	textLabel.BackgroundTransparency = 1
	textLabel.Text = message
	textLabel.Font = Enum.Font.GothamSemibold
	textLabel.TextSize = 16
	textLabel.TextColor3 = color
	textLabel.TextXAlignment = Enum.TextXAlignment.Left
	textLabel.TextWrapped = true

	notification.Parent = PlayerGui

	-- ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏ã‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
	tweenUI(notification, 0.5, {Position = UDim2.new(0.5, 0, 0.05, 0)}, Enum.EasingStyle.Back, Enum.EasingDirection.Out)

	task.delay(duration, function()
		tweenUI(notification, 0.5, {Position = UDim2.new(0.5, 0, -0.2, 0)}, Enum.EasingStyle.Quad, Enum.EasingDirection.In, 
		function() 
			notification:Destroy() 
		end)
	end)

	return notification
end

-- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ UI MedievalMoneyRandomizer
local function findMoneyRandomizerUI()
	-- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô PlayerGui ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
	local moneyUI = PlayerGui:FindFirstChild("MedievalMoneyRandomizer")
	if moneyUI then return moneyUI end

	-- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å ScreenGui
	for _, gui in pairs(PlayerGui:GetChildren()) do
		if gui:IsA("ScreenGui") then
			moneyUI = gui:FindFirstChild("MedievalMoneyRandomizer")
			if moneyUI then return moneyUI end

			-- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô Frame ‡∏•‡∏π‡∏Å
			for _, child in pairs(gui:GetDescendants()) do
				if child:IsA("Frame") and child.Name == "MedievalMoneyRandomizer" then
					return child
				end
			end
		end
	end
	return nil
end

-- ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏°‡∏∏‡∏ô
local function playCardRevealAnimation(frame, onComplete)
	if not frame then 
		if onComplete then onComplete() end
		return 
	end

	log("‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏û‡πà")

	-- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°
	local originalRotation = frame.Rotation or 0
	local originalSize = frame.Size
	local originalPosition = frame.Position
	local originalTransparency = frame.BackgroundTransparency or 0

	-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏û‡πà‡∏´‡∏•‡∏±‡∏á
	local cardBack = Instance.new("Frame")
	cardBack.Name = "CardBack"
	cardBack.Size = originalSize
	cardBack.Position = originalPosition
	cardBack.AnchorPoint = frame.AnchorPoint
	cardBack.BackgroundColor3 = Color3.fromRGB(180, 0, 0)
	cardBack.ZIndex = frame.ZIndex + 1
	cardBack.Parent = frame.Parent

	-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏ö
	local pattern = Instance.new("ImageLabel")
	pattern.Name = "CardPattern"
	pattern.Size = UDim2.fromScale(0.8, 0.8)
	pattern.Position = UDim2.fromScale(0.5, 0.5)
	pattern.AnchorPoint = Vector2.new(0.5, 0.5)
	pattern.BackgroundTransparency = 1
	pattern.Image = "rbxassetid://6127039592"
	pattern.ImageColor3 = Color3.fromRGB(255, 220, 220)
	pattern.ImageTransparency = 0.7
	pattern.ZIndex = cardBack.ZIndex + 1
	pattern.Parent = cardBack

	local border = Instance.new("UIStroke")
	border.Color = Color3.fromRGB(255, 215, 0)
	border.Thickness = 3
	border.Parent = cardBack

	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 8)
	corner.Parent = cardBack

	-- ‡∏ã‡πà‡∏≠‡∏ô frame ‡∏´‡∏•‡∏±‡∏Å
	frame.Visible = false

	-- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
	cardBack.Rotation = 180
	cardBack.Size = UDim2.new(
		originalSize.X.Scale, originalSize.X.Offset * 0.8,
		originalSize.Y.Scale, originalSize.Y.Offset * 0.8
	)

	-- ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏û‡πà‡∏û‡∏•‡∏¥‡∏Å
	playSound(cardBack, "rbxassetid://6732897163", 0.5)

	-- ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏û‡πà
	local numShuffle = 5
	local shuffleDelay = 0.1

	for i = 1, numShuffle do
		task.delay(i * shuffleDelay, function()
			local offsetX = math.random(-10, 10)
			local offsetY = math.random(-10, 10)

			tweenUI(cardBack, shuffleDelay, {
				Position = UDim2.new(
					originalPosition.X.Scale, originalPosition.X.Offset + offsetX,
					originalPosition.Y.Scale, originalPosition.Y.Offset + offsetY
				),
				Rotation = originalRotation + math.random(-15, 15)
			})
		end)
	end

	-- ‡∏û‡∏•‡∏¥‡∏Å‡πÑ‡∏û‡πà‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏∏‡πà‡∏°
	task.delay(numShuffle * shuffleDelay + 0.2, function()
		-- ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏¥‡∏°
		tweenUI(cardBack, 0.3, {
			Position = originalPosition,
			Rotation = 0
		}, Enum.EasingStyle.Back, Enum.EasingDirection.Out, function()
			-- ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î
			playSound(cardBack, "rbxassetid://5852130173", 0.7)

			-- ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏≤‡∏¢‡πÑ‡∏õ
			tweenUI(cardBack, 0.4, {
				Size = UDim2.new(
					originalSize.X.Scale, originalSize.X.Offset * 0.1,
					originalSize.Y.Scale, originalSize.Y.Offset
				),
				Rotation = 90
			}, Enum.EasingStyle.Back, Enum.EasingDirection.In, function()
				-- ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏•‡∏±‡∏á
				cardBack:Destroy()

				-- ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏ô‡πâ‡∏≤
				frame.Visible = true
				frame.Rotation = 90
				frame.Size = UDim2.new(
					originalSize.X.Scale, originalSize.X.Offset * 0.1,
					originalSize.Y.Scale, originalSize.Y.Offset
				)

				-- ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏≤‡∏Å‡∏è
				tweenUI(frame, 0.4, {
					Rotation = 0,
					Size = originalSize,
					BackgroundTransparency = originalTransparency
				}, Enum.EasingStyle.Back, Enum.EasingDirection.Out, function()
					-- ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢
					playSound(frame, "rbxassetid://5852296378", 0.5)

					-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢
					for i = 1, 8 do
						task.delay(i * 0.05, function()
							local sparkle = Instance.new("Frame")
							sparkle.Name = "Sparkle" .. i
							sparkle.Size = UDim2.fromOffset(5, 5)
							sparkle.Position = UDim2.fromScale(math.random(), math.random())
							sparkle.AnchorPoint = Vector2.new(0.5, 0.5)
							sparkle.BackgroundColor3 = Color3.fromRGB(255, 215, 0)
							sparkle.BackgroundTransparency = 0
							sparkle.ZIndex = frame.ZIndex + 5

							local corner = Instance.new("UICorner")
							corner.CornerRadius = UDim.new(1, 0)
							corner.Parent = sparkle

							sparkle.Parent = frame

							tweenUI(sparkle, 0.5, {
								Size = UDim2.fromOffset(20, 20),
								Position = UDim2.fromScale(0.5, 0.5),
								BackgroundTransparency = 1
							}, nil, nil, function()
								sparkle:Destroy()
								if i == 8 and onComplete then onComplete() end
								end)
								end)
								end
								end)
								end)
								end)
								end)
								end

								-- ‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏á‡∏¥‡∏ô
local function getRandomMoneyAmount()
	return math.random(MONEY_RANGE[1], MONEY_RANGE[2])
end

-- ‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
local function showMoneyAnimationWithExistingUI(amount)
	log("üí∞ ‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: " .. amount)

	-- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ UI
	local moneyUI = findMoneyRandomizerUI()
	if not moneyUI then
		log("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö UI ‡πÄ‡∏á‡∏¥‡∏ô ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô")
		createNotification("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö " .. amount .. " ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç!", NOTIFY_DURATION, MONEY_COLOR)
		moneyEventRemote:FireServer("updateMoney", amount)
		return
	end

	-- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ MainFrame
	local mainFrame
	if moneyUI:IsA("Frame") then
		mainFrame = moneyUI
	else
		mainFrame = moneyUI:FindFirstChild("MainFrame")
		if not mainFrame then
			for _, child in pairs(moneyUI:GetDescendants()) do
				if child:IsA("Frame") and (child.Name == "MainFrame" or child.Name:find("Main")) then
					mainFrame = child
					break
				end
			end
		end
	end

	if not mainFrame then
		log("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö MainFrame ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô")
		createNotification("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö " .. amount .. " ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç!", NOTIFY_DURATION, MONEY_COLOR)
		moneyEventRemote:FireServer("updateMoney", amount)
		return
	end

	-- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ CoinAmount
	local coinAmount
	local coinDisplay = mainFrame:FindFirstChild("CoinDisplay")

	if coinDisplay then
		coinAmount = coinDisplay:FindFirstChild("CoinAmount")
	else
		for _, child in pairs(mainFrame:GetDescendants()) do
			if child:IsA("TextLabel") and (
				child.Name == "CoinAmount" or 
					child.Name:find("Amount") or 
					child.Name:find("Money") or
					child.Name:find("Coin")
				) then
				coinAmount = child
				break
			end
		end
	end

	if not coinAmount then
		log("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö CoinAmount ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô")
		createNotification("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö " .. amount .. " ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç!", NOTIFY_DURATION, MONEY_COLOR)
		moneyEventRemote:FireServer("updateMoney", amount)
		return
	end

	-- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î
	local closeButton
	for _, child in pairs(mainFrame:GetDescendants()) do
		if child:IsA("TextButton") and (
			child.Name:find("Close") or 
				child.Name:find("Accept") or 
				child.Name:find("OK") or
				child.Name:find("Button") or
				child.Name:find("Confirm")
			) then
			closeButton = child
			break
		end
	end

	-- ‡πÅ‡∏™‡∏î‡∏á UI ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô
	moneyUI.Enabled = true

	local originalTextSize = coinAmount.TextSize
	coinAmount.Text = "0"

	playCardRevealAnimation(mainFrame, function()
		-- ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
		playSound(mainFrame, "rbxassetid://131323304", 0.5)

		-- ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô
		local countDuration = 2
		local startTime = tick()

		local function easeOutQuart(t)
			return 1 - (1 - t)^4
		end

		local countConnection
		countConnection = RunService.RenderStepped:Connect(function()
			local elapsed = tick() - startTime
			local progress = math.min(elapsed / countDuration, 1)

			local easedProgress = easeOutQuart(progress)
			local currentValue = math.floor(easedProgress * amount)

			coinAmount.Text = tostring(currentValue)

			if progress >= 1 then
				countConnection:Disconnect()

				-- ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
				playSound(mainFrame, "rbxassetid://131323304", 0.7)

				-- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô
				tweenUI(coinAmount, 0.3, {TextSize = originalTextSize * 1.3}, Enum.EasingStyle.Back, Enum.EasingDirection.Out)

				task.delay(0.3, function()
					tweenUI(coinAmount, 0.2, {TextSize = originalTextSize})
				end)

				-- ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏á‡∏¥‡∏ô
				moneyEventRemote:FireServer("updateMoney", amount)

				-- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
				if not closeButton then
					task.delay(5, function()
						mainFrame.Visible = false
					end)
				end
			end
		end)
	end)

	-- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î UI ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°
	if closeButton and not closeButton:GetAttribute("Connected") then
		closeButton.MouseButton1Click:Connect(function()
			mainFrame.Visible = false
		end)
		closeButton:SetAttribute("Connected", true)
	end
end

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
local function checkEndTile()
	-- ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô
	if state.isProcessingEvent then 
		log("üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß")
		return 
	end

	-- ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
	if state.isMoving then
		log("üö∂ ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà")
		return
	end

	if not state.hasReachedEndTile then
		log("üîÑ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á")
		return
	end

	-- ‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
	if state.pendingMoneyTile then
		log("üèÅ‚úÖ ‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≠")

		state.isProcessingEvent = true
		state.pendingMoneyTile = false

		-- ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô
		state.moneyAmount = getRandomMoneyAmount()

		-- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á UI
		createNotification("‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß! ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö " .. state.moneyAmount .. " ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç", NOTIFY_DURATION)

		task.delay(DELAY_BEFORE_UI, function()
			showMoneyAnimationWithExistingUI(state.moneyAmount)
			state.isProcessingEvent = false
		end)
	else
		log("üèÅ ‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≠")
	end

	state.hasReachedEndTile = false
end

-- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå
local function setupConnections()
	-- ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏á‡∏¥‡∏ô
	moneyEventRemote.OnClientEvent:Connect(function(amount)
		if amount and amount > 0 then
			createNotification("‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö " .. amount .. " ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç", NOTIFY_DURATION, MONEY_COLOR)
			showMoneyAnimationWithExistingUI(amount)
		end
	end)

	-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
	startPlayerMovementPath.OnClientEvent:Connect(function(playerId, movementData)
		if playerId ~= player.UserId then return end

		log("üö∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≤‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á")
		state.isMoving = true
		state.hasReachedEndTile = false
	end)

	-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
	playerArrivedAtTile.OnClientEvent:Connect(function(playerId, finalTileId)
		if playerId ~= player.UserId then return end

		log("üèÅ ‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á: " .. finalTileId)
		state.lastTileId = finalTileId
		state.isMakingPathChoice = false
	end)

	-- ‡∏ï‡∏≠‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á
	if showPathSelection then
		showPathSelection.OnClientEvent:Connect(function()
			log("üß≠ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á")
			state.isMakingPathChoice = true
		end)
	end

	-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå
	if movementVisualizationComplete then
		movementVisualizationComplete.OnClientEvent:Connect(function(finalTileId)
			log("‚úÖ ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå: " .. finalTileId)
			state.lastTileId = finalTileId
			state.isMoving = false
			state.hasReachedEndTile = true
			state.isMakingPathChoice = false

			task.delay(DELAY_BEFORE_UI, checkEndTile)
		end)
	end

	-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô
	if activityComplete then
		activityComplete.OnClientEvent:Connect(function(activityType)
			if activityType == "movement" or activityType == "turn" then
				state.isMoving = false
				state.hasReachedEndTile = true
				checkEndTile()
			end
		end)
	end

	-- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á
	tileTriggerEvent.OnClientEvent:Connect(function(playerId, tileId, tileType)
		if playerId ~= player.UserId then return end

		log("‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á: " .. tileId .. " ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó " .. tileType)
		state.lastTileId = tileId
		state.lastTileType = tileType

		if state.isMakingPathChoice then
			log("‚è© ‡∏Ç‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á")
			return
		end

		-- ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ä‡πà‡∏≠‡∏á
		if tileType == "money" then
			createNotification("‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô! ‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á", 2, MONEY_COLOR)
			state.pendingMoneyTile = true
		elseif tileType == "shop" then
			createNotification("‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤", 2, SHOP_COLOR)
		elseif tileType == "battle" then
			createNotification("‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ! ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°", 2, BATTLE_COLOR)
		elseif tileType == "casino" then
			createNotification("‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏≤‡∏™‡∏¥‡πÇ‡∏ô! ‡∏≠‡∏¢‡∏≤‡∏Å‡∏•‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÇ‡∏ä‡∏Ñ‡πÑ‡∏´‡∏°?", 2, CASINO_COLOR)
		elseif tileType == "item" then
			createNotification("‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÑ‡∏≠‡πÄ‡∏ó‡∏°! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏≠‡πÄ‡∏ó‡∏°...", 2, ITEM_COLOR)
		end
	end)

	-- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á
	task.spawn(function()
		local PlayerGui = player:WaitForChild("PlayerGui")
		local PopupUI = PlayerGui:WaitForChild("PopupUI", 10)
		if PopupUI then
			local DiceRollUI = PopupUI:WaitForChild("DiceRollUI", 10)
			if DiceRollUI then
				local PathSelectionContainer = DiceRollUI:WaitForChild("PathSelectionContainer", 10)
				if PathSelectionContainer then
					PathSelectionContainer:GetPropertyChangedSignal("Visible"):Connect(function()
						state.isMakingPathChoice = PathSelectionContainer.Visible
						log("üìç ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á: " .. (state.isMakingPathChoice and "‡πÄ‡∏õ‡∏¥‡∏î" or "‡∏õ‡∏¥‡∏î"))
					end)
				end
			end
		end
	end)

	-- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£
	task.spawn(function()
		while true do
			task.wait(0.5) -- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å 0.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

			local character = player.Character
			if character and character:FindFirstChild("HumanoidRootPart") and character:FindFirstChild("Humanoid") then
				local humanoid = character:FindFirstChild("Humanoid")

				-- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
				if humanoid.MoveDirection.Magnitude > 0 then
					if not state.isMoving then
						log("üö∂ ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà")
						state.isMoving = true
						state.hasReachedEndTile = false
					end
				else
					if state.isMoving then
						log("üõë ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà")
						state.isMoving = false

						task.delay(DELAY_BEFORE_UI, function()
							if state.pendingMoneyTile and not state.isMoving then
								log("üîÑ ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏´‡∏¢‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≠")
								state.hasReachedEndTile = true
								checkEndTile()
							end
						end)
					end
				end
			end
		end
	end)
end

-- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö
local function setupTestFunctions()
	-- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö UI ‡πÄ‡∏á‡∏¥‡∏ô
	_G.TestMoneyUI = function(amount)
		amount = amount or getRandomMoneyAmount()
		log("‡∏ó‡∏î‡∏™‡∏≠‡∏ö UI ‡πÄ‡∏á‡∏¥‡∏ô: " .. amount)
		showMoneyAnimationWithExistingUI(amount)
		return "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö UI ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô: " .. amount .. " ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç"
	end

	-- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î
	_G.TestCardAnimation = function()
		local moneyUI = findMoneyRandomizerUI()
		if moneyUI then
			local mainFrame = moneyUI:IsA("Frame") and moneyUI or moneyUI:FindFirstChild("MainFrame")
			if mainFrame then
				moneyUI.Enabled = true
				mainFrame.Visible = true
				playCardRevealAnimation(mainFrame)
				return "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î"
			end
		end
		return "‡πÑ‡∏°‡πà‡∏û‡∏ö UI ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö"
	end

	-- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô
	_G.TestMoneyTileSequence = function()
		log("‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á")

		-- ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
		state.pendingMoneyTile = false
		state.isMoving = false
		state.hasReachedEndTile = false
		state.isProcessingEvent = false

		-- ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô
		state.pendingMoneyTile = true
		createNotification("‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô! ‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á", 2, MONEY_COLOR)

		-- ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
		log("‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà...")
		state.isMoving = true

		-- ‡∏£‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏∏‡∏î
		task.delay(2, function()
			log("‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á")
			state.isMoving = false
			state.hasReachedEndTile = true
			checkEndTile()
		end)

		return "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ï‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á"
	end
end

-- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
local function initialize()
	log("‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö EventTileHandler...")

	initRemotes()
	setupConnections()
	setupTestFunctions()

	-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö UI ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
	task.spawn(function()
		task.wait(2)
		local ui = findMoneyRandomizerUI()
		log(ui and "‚úÖ ‡∏û‡∏ö UI MedievalMoneyRandomizer" or "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö UI MedievalMoneyRandomizer")
	end)

	log("‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß")
	print("================ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡πÄ‡∏®‡∏© (Event Tile) ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ================")
	print("‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢: _G.TestMoneyUI(), _G.TestCardAnimation(), _G.TestMoneyTileSequence()")
end

-- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
initialize()
